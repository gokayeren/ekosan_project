{% extends "base.html" %}

{% block title %}{{ service.meta_title or service.title }} - Ekosan{% endblock %}
{% block description %}{{ service.meta_description or service.short_description }}{% endblock %}

{% block content %}

<div class="relative w-full h-[250px] lg:h-[350px] bg-neutral-900 overflow-hidden">
    <div class="absolute inset-0 z-0">
        {% if service.detail_image_path %}
            <img src="{{ url_for('static', filename='uploads/' + service.detail_image_path) }}" 
                 class="w-full h-full object-cover opacity-40" alt="{{ service.title }}">
        {% elif service.image_path %}
            <img src="{{ url_for('static', filename='uploads/' + service.image_path) }}" 
                 class="w-full h-full object-cover opacity-40 blur-sm" alt="{{ service.title }}">
        {% else %}
            <div class="w-full h-full bg-slate-900 opacity-40"></div>
        {% endif %}
    </div>
    
    <div class="absolute inset-0 bg-gradient-to-r from-black/80 via-black/40 to-transparent z-10"></div>
    
    <div class="relative z-20 container mx-auto px-4 h-full flex flex-col justify-center items-start text-left">
        <h1 class="text-3xl md:text-5xl font-black text-white tracking-tight mb-3 uppercase drop-shadow-lg">
            {{ service.title }}
        </h1>
        
        <div class="flex items-center gap-2 text-xs md:text-sm font-medium text-gray-300">
            <a href="{{ url_for('main.index') }}" class="hover:text-blue-500 transition-colors">Anasayfa</a>
            <i class="fa fa-chevron-right text-[10px] opacity-50"></i>
            <span class="text-blue-500">Hizmetlerimiz</span>
            <i class="fa fa-chevron-right text-[10px] opacity-50"></i>
            <span class="text-white opacity-80">{{ service.title }}</span>
        </div>
    </div>
</div>

<section class="py-12 lg:py-20 bg-white relative">
    <div class="container mx-auto px-4 max-w-7xl">
        
        <div class="max-w-4xl mb-12 space-y-3">
            <h2 class="text-2xl md:text-3xl font-black text-slate-900 uppercase leading-tight">
                <span class="text-blue-600">{{ service.title }}</span> ÇÖZÜMLERİ
            </h2>
            {% if service.subtitle %}
            <p class="text-slate-500 font-medium text-base md:text-lg leading-relaxed">
                {{ service.subtitle }}
            </p>
            {% endif %}
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 lg:gap-16 items-start mb-20">
            
            <div class="w-full">
                {% if service.slider_group and service.slider_group.items %}
                    <div class="swiper serviceDetailSwiper w-full bg-transparent">
                        <div class="swiper-wrapper">
                            {% for item in service.slider_group.items %}
                            <div class="swiper-slide rounded-xl overflow-hidden aspect-[4/3] bg-slate-100 shadow-lg border border-slate-100">
                                <img src="{{ url_for('static', filename='uploads/' + item.image_path) }}" 
                                     alt="{{ item.title }}" 
                                     class="w-full h-full object-cover">
                                
                                {% if item.title %}
                                <div class="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent pointer-events-none">
                                    <h4 class="text-white font-bold text-lg">{{ item.title }}</h4>
                                </div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div class="swiper-pagination"></div>
                    </div>

                {% elif service.image_path %}
                    <div class="rounded-xl overflow-hidden shadow-lg border border-slate-100 aspect-[4/3] bg-slate-100">
                         <img src="{{ url_for('static', filename='uploads/' + service.image_path) }}" 
                              class="w-full h-full object-cover" 
                              alt="{{ service.title }}">
                    </div>
                {% endif %}
            </div>

            <div class="flex flex-col h-full space-y-6">
                <div>
                    <h3 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                        <span class="w-2 h-8 bg-blue-600 rounded-sm"></span>
                        {{ service.features_title or 'Öne Çıkan Özellikler' }}
                    </h3>
                    
                    <div class="prose prose-slate prose-ul:list-none prose-ul:pl-0 prose-li:pl-0">
                        {% if service.features %}
                            <div class="custom-features-list text-slate-600">
                                {{ service.features | safe }}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <div class="flex flex-wrap gap-4 pt-6 mt-auto">
                    {% if service.video_url %}
                    <a href="{{ service.video_url }}" target="_blank" 
                       class="btn h-12 px-6 bg-slate-900 hover:bg-blue-600 text-white border-none rounded-lg shadow-md flex items-center gap-3 transition-colors">
                        <i class="fa fa-play text-xs"></i>
                        <span>{{ service.video_btn_text or 'Filmi İzle' }}</span>
                    </a>
                    {% endif %}

                    <a href="{{ url_for('main.contact') }}" 
                       class="btn h-12 px-6 bg-white hover:bg-slate-50 text-slate-800 border border-slate-200 rounded-lg shadow-sm flex items-center gap-2">
                        <span>Teklif Al</span>
                        <i class="fa fa-arrow-right text-slate-400"></i>
                    </a>
                </div>
            </div>

        </div>

        <div class="bg-slate-50 rounded-2xl p-8 md:p-12 border border-slate-100 mb-16">
            <h3 class="text-xl font-bold text-slate-800 mb-6">
                {{ service.description_title or 'Detaylı Bilgiler' }}
            </h3>
            
            <div class="prose prose-lg prose-slate max-w-none prose-a:text-blue-600">
                {% if service.description %}
                    {{ service.description | safe }}
                {% else %}
                    <p class="text-slate-500 text-sm">İçerik hazırlanıyor...</p>
                {% endif %}
            </div>
        </div>

        {% if service.faq_group and service.faq_group.items %}
        <div class="max-w-4xl mx-auto border-t border-slate-100 pt-16">
            <div class="text-center mb-10">
                <h3 class="text-2xl font-bold text-slate-900">Sıkça Sorulan Sorular</h3>
            </div>

            <div class="space-y-3">
                {% for faq in service.faq_group.items %}
                    {% if faq.is_active %}
                    <details class="group bg-white rounded-lg border border-slate-200 overflow-hidden [&_summary::-webkit-details-marker]:hidden">
                        <summary class="flex items-center justify-between p-5 cursor-pointer text-slate-700 font-bold hover:bg-slate-50 transition-colors">
                            <span>{{ faq.question }}</span>
                            <span class="transition-transform duration-300 group-open:rotate-180">
                                <i class="fa fa-chevron-down text-xs text-slate-400"></i>
                            </span>
                        </summary>
                        <div class="px-5 pb-5 text-slate-600 text-sm leading-relaxed border-t border-slate-50">
                            {{ faq.answer | safe }}
                        </div>
                    </details>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endif %}

    </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", function() {
    var swiper = new Swiper(".serviceDetailSwiper", {
        spaceBetween: 20,
        effect: "fade",
        fadeEffect: { crossFade: true },
        loop: true,
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
    });
});
</script>

<style>
    /* Swiper Dışarıda Pagination Ayarı */
    .serviceDetailSwiper {
        padding-bottom: 40px !important; /* Noktalar için alt boşluk */
    }

    .serviceDetailSwiper .swiper-pagination {
        bottom: 0 !important; /* En alta sabitle */
    }

    /* Mavi Noktalar */
    .serviceDetailSwiper .swiper-pagination-bullet {
        width: 10px;
        height: 10px;
        background-color: #cbd5e1; /* Pasif gri */
        opacity: 1;
        margin: 0 6px !important;
    }

    .serviceDetailSwiper .swiper-pagination-bullet-active {
        background-color: #2563eb; /* Aktif Mavi */
        width: 20px;
        border-radius: 10px;
        transition: all 0.3s;
    }

    /* Özellik Listesi Tikleri */
    .custom-features-list ul { list-style: none; padding: 0; margin: 0; }
    .custom-features-list li {
        position: relative;
        padding-left: 1.5rem;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: start;
    }
    .custom-features-list li::before {
        content: '\f00c';
        font-family: 'Font Awesome 6 Free';
        font-weight: 900;
        position: absolute;
        left: 0;
        top: 0.3rem;
        color: #2563eb; /* Mavi Tik */
        font-size: 0.8rem;
    }
</style>

{% endblock %}